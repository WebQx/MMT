[build]
builder = "nixpacks"

[deploy]
startCommand = "python run.py"
healthcheckPath = "/health/live"
healthcheckTimeout = 30
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[variables]
ENV = "prod"
ENVIRONMENT_NAME = "production"
DEMO_MODE = "false"
INCLUDE_ML = "true"
ENABLE_LOCAL_TRANSCRIPTION = "true"
ENABLE_CLOUD_TRANSCRIPTION = "true"
INTERNAL_JWT_SECRET = "railway_production_jwt_secret_32_chars_long_abcdef1234567890"
ALLOW_GUEST_AUTH = "true"
RABBITMQ_URL = "amqp://guest:guest@localhost:5672/"
# MySQL connection will be configured via Railway's MySQL addon
# Railway will automatically provide: MYSQLHOST, MYSQLPORT, MYSQLUSER, MYSQLPASSWORD, MYSQLDATABASE
TRANSCRIPTS_DB_HOST = "${{MYSQLHOST}}"
TRANSCRIPTS_DB_PORT = "${{MYSQLPORT}}"
TRANSCRIPTS_DB_USER = "${{MYSQLUSER}}"
TRANSCRIPTS_DB_PASSWORD = "${{MYSQLPASSWORD}}"
TRANSCRIPTS_DB_NAME = "${{MYSQLDATABASE}}"

[[services]]
name = "backend"